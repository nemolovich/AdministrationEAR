<?xml version='1.0' encoding='UTF-8' ?>
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml"
      xmlns:h="http://java.sun.com/jsf/html"
      xmlns:f="http://java.sun.com/jsf/core"
      xmlns:ui="http://java.sun.com/jsf/facelets"
      xmlns:p="http://primefaces.org/ui">
    <h:head>
        <title>Paramètres société</title>
    </h:head>
    <h:body>
        
    	<ui:composition template="/templates/page_template.xhtml">
            <ui:define name="title">
                | Paramètres société
            </ui:define>
            <ui:define name="content">
                <f:attribute name="header" value="Modification des paramètres d'une société"/>
                <ui:include src="/restricted/admin/data/client/popups/devices.xhtml"/>
                <ui:include src="/restricted/admin/data/client/popups/mails.xhtml"/>
                <ui:include src="/restricted/admin/data/client/popups/cusers.xhtml"/>
                <ui:include src="/restricted/admin/data/client/popups/softwares.xhtml"/>
                <f:view>
                    <h:form id="clientUpdate" enctype="multipart/form-data">
                        
                        <p:commandButton action="list"
                                         value="Retour à la liste des sociétés"
                                         title="Retourner à la liste des sociétés"
                                         icon="ui-icon-arrowthick-1-w"
                                         immediate="true"
                                         styleClass="red_icon"/>
                        
                        <div class="ui-messages ui-widget">
                            <div class="ui-messages-warn ui-corner-all">
                                <span class="ui-messages-warn-icon"/>
                                <ul>
                                    <li>
                                        <span class="ui-messages-warn-summary">
                                            Attention! La modification de ces données est instantanée.
                                        </span>
                                    </li>
                                </ul>
                            </div>
                        </div>
                        <p:tabView id="clientTabView" cache="false" dynamic="true" effect="slide"
                                   widgetVar="clientTabSelect">
                            <p:tab id="devices" title="Périphériques">
                                <script type="text/javascript">
                                    $(document).ready(function()
                                    {
                                        clientDeviceTable.filter();
                                    });
                                </script>
                                <p:dataTable id="clientDeviceList"
                                             value="#{deviceMultiView.getData(clientView.entity.deviceList)}"
                                             var="device"
                                             widgetVar="clientDeviceTable"
                                             rowIndexVar="index"
                                             paginatorPosition="bottom"
                                             emptyMessage="Aucun périphérique n'a été trouvé"
                                             rowStyleClass="#{device.sleeping?'sleeping_elmt':null}"
                                             paginator="true"
                                             rows="#{utils.maxDataRows}"
                                             sortBy="#{device.id}"
                                             filteredValue="#{deviceMultiView.filteredEntities}"
                                             selection="#{deviceMultiView.multiSelection}">
                                    
                                    <p:ajax event="rowSelectCheckbox"
                                            process="@this"
                                            update=":createDeviceForm
                                             clientDeviceList:deviceDelete" />
                                    <p:ajax event="rowUnselectCheckbox"
                                            process="@this"
                                            update=":createDeviceForm
                                             clientDeviceList:deviceDelete" />
                                    <p:ajax event="toggleSelect"
                                            process="@this"
                                            update=":createDeviceForm
                                             clientDeviceList:deviceDelete" />

                                    <p:column selectionMode="multiple" style="width:2%">
                                    </p:column>

                                    <p:column headerText="Détails" style="width:100%;">
                                        <h:outputText value="#{device.toString()}"/>
                                    </p:column>
                                    
                                    <p:column headerText="Actions" style="white-space: nowrap;">
                                        <p:commandButton actionListener="#{deviceView.entityView(device)}"
                                                         icon="ui-icon-search"
                                                         style="font-size: 60%;"
                                                         title="Détails de ce périphérique"
                                                         update=":createDeviceForm"
                                                         oncomplete="createDevice.show();"/>
                                        <p:commandButton actionListener="#{deviceView.entityUpdate(device)}"
                                                         icon="ui-icon-pencil"
                                                         style="font-size: 60%;"
                                                         title="Modifier ce périphérique"
                                                         update=":createDeviceForm"
                                                         oncomplete="createDevice.show();"/>
                                        <p:commandButton actionListener="#{deviceView.entityDelete(clientView.entity, device)}"
                                                         action="javascipt:void(0);"
                                                         icon="ui-icon-trash"
                                                         oncomplete="clientDeviceTable.filter();"
                                                         update=":clientUpdate :growl :clientUpdate:clientTabView:clientDeviceList"
                                                         style="font-size: 60%;"
                                                         styleClass="red_icon"
                                                         onclick="if(!confirm('#{deviceView.getDeleteMessage(device)}')){return false;}"
                                                         title="Supprimer ce périphérique"/>
                                    </p:column>
                                    
                                    <p:column id="sleepingDeviceTab"
                                              headerText="État"
                                              sortBy="#{device.sleeping}"
                                              style="width:2%;">
                                        <p:commandButton actionListener="#{deviceView.entityWake(clientView.entity,device)}"
                                                         action="javascript:void(0);"
                                                         icon="ui-icon-play"
                                                         update=":growl :clientUpdate:clientTabView:clientDeviceList"
                                                         style="font-size: 60%;float:right;"
                                                         styleClass="blue_icon"
                                                         title="Réactiver ce périphérique"
                                                         rendered="#{device.sleeping}"/>
                                        <p:commandButton id="setDeviceSleepingButton"
                                                         actionListener="#{deviceView.entitySleep(clientView.entity,device)}"
                                                         action="javascript:void(0);"
                                                         icon="ui-icon-pause"
                                                         oncomplete="clientDeviceTable.filter();"
                                                         update=":growl :clientUpdate:clientTabView:clientDeviceList"
                                                         style="font-size: 60%;float:right;"
                                                         onclick="if(!confirm('Voulez vous vraiment mettre ce périphérique en standby?\n'+
                                                                        '(Vous pourrez le réactiver quand vous le souhaitez)'))
                                                                           {return false;}"
                                                         styleClass="red_icon"
                                                         title="Mettre en standby ce périphérique"
                                                         rendered="#{not device.sleeping}"/>
                                    </p:column>
                                    
                                    <f:facet name="footer">
                                        <p:outputPanel style="float:left">
                                            <p:commandButton value="Ajouter un périphérique"
                                                             icon="ui-icon-circle-plus"
                                                             styleClass="green_icon"
                                                             title="Ajouter un périphérique à cette société"
                                                             update=":createDeviceForm"
                                                             actionListener="#{deviceView.entityCreate(clientView.entity)}"
                                                             onclick="createDevice.show();"/>
                                            <p:commandButton id="deviceDelete"
                                                             value="Supprimer"
                                                             icon="ui-icon-trash"
                                                             widgetVar="deviceDeleteButton"
                                                             styleClass="red_icon"
                                                             title="Supprimer les périphériques sélectionnés"
                                                             update=":clientUpdate :growl :clientUpdate:clientTabView:clientDeviceList @this"
                                                             disabled="#{deviceMultiView.emptySelection}"
                                                             actionListener="#{deviceView.remove(clientView.entity,
                                                                               deviceMultiView.multiSelection)}"
                                                             oncomplete="if(#{deviceMultiView.checkEmptySelection()}!='true'){
                                                                    clientDeviceTable.filter();}"
                                                             onclick="if(#{deviceMultiView.emptySelection})
                                                                {return false;}
                                                                else{if(!confirm('#{deviceView.deleteMessages(deviceMultiView.multiSelectionCast)}')){return false;}}"/>
                                            <p:outputLabel for="checkDisplayDeviceSleeping"
                                                           value="Afficher tout"
                                                           style="font-size:75%;margin-bottom: 10px !important;margin-left: 10px;"/>
                                            <p:selectBooleanCheckbox id="checkDisplayDeviceSleeping"
                                                                     value="#{deviceMultiView.displaySleepingEntities}"
                                                                     styleClass="small_check"
                                                                     style="vertical-align: middle !important;margin-bottom: 5px !important;">  
                                                <p:ajax update="clientDeviceList:deviceDelete 
                                                        :clientUpdate:clientTabView:clientDeviceList"
                                                        oncomplete="clientDeviceTable.clearSelection();
                                                        deviceDeleteButton.disable();forceFilter(clientDeviceTable);"
                                                        immediate="false"/>
                                                <script type="text/javascript">
                                                    addTitle("clientUpdate\\:clientTabView\\:clientDeviceList\\:checkDisplayDeviceSleeping",
                                                             "Affiche les périphériques en sommeil en plus de ceux actifs");
                                                </script>
                                            </p:selectBooleanCheckbox>
                                        </p:outputPanel>
                                    </f:facet>
                                </p:dataTable>
                                <script type="text/javascript">
                                    $(document).ready(function()
                                    {
                                        clientDeviceTable.filter();
                                    });
                                </script>
                            </p:tab>
                            
                            <p:tab id="emails" title="E-Mails">
                                <p:dataTable id="clientMailList"
                                             var="mail"
                                             widgetVar="clientMailTable"
                                             rowIndexVar="index"
                                             paginatorPosition="bottom"
                                             emptyMessage="Aucune adresse mail n'a été trouvée"
                                             rowStyleClass="#{mail.sleeping?'sleeping_elmt':null}"
                                             value="#{mailMultiView.getData(clientView.entity.mailList)}"
                                             paginator="true"
                                             rows="#{utils.maxDataRows}"
                                             sortBy="#{mail.id}"
                                             filteredValue="#{mailMultiView.filteredEntities}"
                                             selection="#{mailMultiView.multiSelection}">
                                    
                                    <p:ajax event="rowSelectCheckbox"
                                            process="@this"
                                            update=":createMailForm
                                             clientMailList:mailDelete" />
                                    <p:ajax event="rowUnselectCheckbox"
                                            process="@this"
                                            update=":createMailForm
                                             clientMailList:mailDelete" />
                                    <p:ajax event="toggleSelect"
                                            process="@this"
                                            update=":createMailForm
                                             clientMailList:mailDelete" />

                                    <p:column selectionMode="multiple" style="width:2%">
                                    </p:column>

                                    <p:column headerText="Détails" style="width:100%;">
                                        <h:outputText value="#{mail.toString()}"/>
                                    </p:column>
                                    
                                    <p:column headerText="Actions" style="white-space: nowrap;">
                                        <p:commandButton actionListener="#{mailView.entityView(mail)}"
                                                         icon="ui-icon-search"
                                                         style="font-size: 60%;"
                                                         title="Détails de cette adresse mail"
                                                         update=":createMailForm"
                                                         oncomplete="createMail.show();"/>
                                        <p:commandButton actionListener="#{mailView.entityUpdate(mail)}"
                                                         icon="ui-icon-pencil"
                                                         style="font-size: 60%;"
                                                         title="Modifier cette adresse mail"
                                                         update=":createMailForm"
                                                         oncomplete="createMail.show();"/>
                                        <p:commandButton actionListener="#{mailView.entityDelete(clientView.entity, mail)}"
                                                         action="javascipt:void(0);"
                                                         icon="ui-icon-trash"
                                                         oncomplete="forceFilter(clientMailTable);"
                                                         update=":clientUpdate :growl :clientUpdate:clientTabView:clientMailList"
                                                         style="font-size: 60%;"
                                                         styleClass="red_icon"
                                                         onclick="if(!confirm('#{mailView.getDeleteMessage(mail)}')){return false;}"
                                                         title="Supprimer cette adresse mail"/>
                                    </p:column>
                                    
                                    <p:column id="sleepingMailTab"
                                              headerText="État"
                                              sortBy="#{mail.sleeping}"
                                              style="width:2%;">
                                        <p:commandButton actionListener="#{mailView.entityWake(clientView.entity,mail)}"
                                                         action="javascript:void(0);"
                                                         icon="ui-icon-play"
                                                         update=":growl :clientUpdate:clientTabView:clientMailList"
                                                         style="font-size: 60%;float:right;"
                                                         styleClass="blue_icon"
                                                         title="Réactiver cette adresse mail"
                                                         rendered="#{mail.sleeping}"/>
                                        <p:commandButton id="setMailSleepingButton"
                                                         actionListener="#{mailView.entitySleep(clientView.entity,mail)}"
                                                         action="javascript:void(0);"
                                                         icon="ui-icon-pause"
                                                         oncomplete="clientMailTable.filter();"
                                                         update=":growl :clientUpdate:clientTabView:clientMailList"
                                                         style="font-size: 60%;float:right;"
                                                         onclick="if(!confirm('Voulez vous vraiment mettre cette adresse mail en standby?\n'+
                                                                        '(Vous pourrez la réactiver quand vous le souhaitez)'))
                                                                           {return false;}"
                                                         styleClass="red_icon"
                                                         title="Mettre en standby cette adresse mail"
                                                         rendered="#{not mail.sleeping}"/>
                                    </p:column>
                                    
                                    <f:facet name="footer">
                                        <p:outputPanel style="float:left">
                                            <p:commandButton value="Ajouter un mail"
                                                             icon="ui-icon-circle-plus"
                                                             styleClass="green_icon"
                                                             title="Ajouter une adresse mail à cette société"
                                                             update=":createMailForm"
                                                             actionListener="#{mailView.entityCreate(clientView.entity)}"
                                                             onclick="createMail.show();"/>
                                            <p:commandButton id="mailDelete"
                                                             value="Supprimer"
                                                             icon="ui-icon-trash"
                                                             widgetVar="mailDeleteButton"
                                                             styleClass="red_icon"
                                                             title="Supprimer les adresses mail sélectionnées"
                                                             update=":clientUpdate :growl :clientUpdate:clientTabView:clientMailList @this"
                                                             disabled="#{mailMultiView.emptySelection}"
                                                             actionListener="#{mailView.remove(clientView.entity,
                                                                               mailMultiView.multiSelection)}"
                                                             oncomplete="if(#{mailMultiView.checkEmptySelection()}!='true'){
                                                                    forceFilter(clientMailTable);}"
                                                             onclick="if(#{mailMultiView.emptySelection})
                                                                {return false;}
                                                                else{if(!confirm('#{mailView.deleteMessages(mailMultiView.multiSelectionCast)}')){return false;}}"/>
                                            <p:outputLabel for="checkDisplayMailSleeping"
                                                           value="Afficher tout"
                                                           style="font-size:75%;margin-bottom: 10px !important;margin-left: 10px;"/>
                                            <p:selectBooleanCheckbox id="checkDisplayMailSleeping"
                                                                     value="#{mailMultiView.displaySleepingEntities}"
                                                                     styleClass="small_check"
                                                                     style="vertical-align: middle !important;margin-bottom: 5px !important;">  
                                                <p:ajax update="clientMailList:mailDelete 
                                                        :clientUpdate:clientTabView:clientMailList"
                                                        oncomplete="clientMailTable.clearSelection();
                                                        mailDeleteButton.disable();forceFilter(clientMailTable);"
                                                        immediate="false"/>
                                                <script type="text/javascript">
                                                    addTitle("clientUpdate\\:clientTabView\\:clientMailList\\:checkDisplayMailSleeping",
                                                             "Affiche les adresses mail en sommeil en plus de celles actives");
                                                </script>
                                            </p:selectBooleanCheckbox>
                                        </p:outputPanel>
                                    </f:facet>
                                </p:dataTable>
                                <script type="text/javascript">
                                    $(document).ready(function()
                                    {
                                        forceFilter(clientMailTable);
                                    });
                                </script>
                            </p:tab>
                            
                            <p:tab id="users" title="Utilisateurs">
                                <p:dataTable id="clientUserList"
                                             var="cuser"
                                             widgetVar="clientUserTable"
                                             rowIndexVar="index"
                                             paginatorPosition="bottom"
                                             emptyMessage="Aucun utilisateur n'a été trouvé"
                                             rowStyleClass="#{cuser.sleeping?'sleeping_elmt':null}"
                                             value="#{cUserMultiView.getData(clientView.entity.CUserList)}"
                                             paginator="true"
                                             rows="#{utils.maxDataRows}"
                                             sortBy="#{cuser.id}"
                                             filteredValue="#{cUserMultiView.filteredEntities}"
                                             selection="#{cUserMultiView.multiSelection}">
                                    
                                    <p:ajax event="rowSelectCheckbox"
                                            process="@this"
                                            update=":createUserForm
                                             clientUserList:userDelete" />
                                    <p:ajax event="rowUnselectCheckbox"
                                            process="@this"
                                            update=":createUserForm
                                             clientUserList:userDelete" />
                                    <p:ajax event="toggleSelect"
                                            process="@this"
                                            update=":createUserForm
                                             clientUserList:userDelete" />

                                    <p:column selectionMode="multiple" style="width:2%">
                                    </p:column>

                                    <p:column headerText="Détails" style="width:100%;">
                                        <h:outputText value="#{cuser.toString()}"/>
                                    </p:column>
                                    
                                    <p:column headerText="Actions" style="white-space: nowrap;">
                                        <p:commandButton actionListener="#{cUserView.entityView(cuser)}"
                                                         icon="ui-icon-search"
                                                         style="font-size: 60%;"
                                                         title="Détails de cet utilisateur"
                                                         update=":createUserForm"
                                                         oncomplete="createUser.show();"/>
                                        <p:commandButton actionListener="#{cUserView.entityUpdate(cuser)}"
                                                         icon="ui-icon-pencil"
                                                         style="font-size: 60%;"
                                                         title="Modifier cet utilisateur"
                                                         update=":createUserForm"
                                                         oncomplete="createUser.show();"/>
                                        <p:commandButton actionListener="#{cUserView.entityDelete(clientView.entity, cuser)}"
                                                         action="javascipt:void(0);"
                                                         icon="ui-icon-trash"
                                                         oncomplete="forceFilter(clientUserTable);"
                                                         update=":clientUpdate :growl :clientUpdate:clientTabView:clientUserList"
                                                         style="font-size: 60%;"
                                                         styleClass="red_icon"
                                                         onclick="if(!confirm('#{cUserView.getDeleteMessage(cuser)}')){return false;}"
                                                         title="Supprimer cet utilisateur"/>
                                    </p:column>
                                    
                                    <p:column id="sleepingUserTab"
                                              headerText="État"
                                              sortBy="#{cuser.sleeping}"
                                              style="width:2%;">
                                        <p:commandButton actionListener="#{cUserView.entityWake(clientView.entity,cuser)}"
                                                         action="javascript:void(0);"
                                                         icon="ui-icon-play"
                                                         update=":growl :clientUpdate:clientTabView:clientUserList"
                                                         style="font-size: 60%;float:right;"
                                                         styleClass="blue_icon"
                                                         title="Réactiver cet utilisateur"
                                                         rendered="#{cuser.sleeping}"/>
                                        <p:commandButton id="setUserSleepingButton"
                                                         actionListener="#{cUserView.entitySleep(clientView.entity,cuser)}"
                                                         action="javascript:void(0);"
                                                         icon="ui-icon-pause"
                                                         oncomplete="clientUserTable.filter();"
                                                         update=":growl :clientUpdate:clientTabView:clientUserList"
                                                         style="font-size: 60%;float:right;"
                                                         onclick="if(!confirm('Voulez vous vraiment mettre cet utilisateur en standby?\n'+
                                                                        '(Vous pourrez le réactiver quand vous le souhaitez)'))
                                                                           {return false;}"
                                                         styleClass="red_icon"
                                                         title="Mettre en standby cet utilisateur"
                                                         rendered="#{not cuser.sleeping}"/>
                                    </p:column>
                                    
                                    <f:facet name="footer">
                                        <p:outputPanel style="float:left">
                                            <p:commandButton value="Ajouter un utilisateur"
                                                             icon="ui-icon-circle-plus"
                                                             styleClass="green_icon"
                                                             title="Ajouter un utilisateur à cette société"
                                                             update=":createUserForm"
                                                             actionListener="#{cUserView.entityCreate(clientView.entity)}"
                                                             onclick="createUser.show();"/>
                                            <p:commandButton id="userDelete"
                                                             value="Supprimer"
                                                             icon="ui-icon-trash"
                                                             widgetVar="userDeleteButton"
                                                             styleClass="red_icon"
                                                             title="Supprimer les utilisateurs sélectionnés"
                                                             update=":clientUpdate :growl :clientUpdate:clientTabView:clientUserList @this"
                                                             disabled="#{cUserMultiView.emptySelection}"
                                                             actionListener="#{cUserView.remove(clientView.entity,
                                                                               cUserMultiView.multiSelection)}"
                                                             oncomplete="if(#{cUserMultiView.checkEmptySelection()}!='true'){
                                                                    forceFilter(clientUserTable);}"
                                                             onclick="if(#{cUserMultiView.emptySelection})
                                                                {return false;}
                                                                else{if(!confirm('#{cUserView.deleteMessages(cUserMultiView.multiSelectionCast)}')){return false;}}"/>
                                            <p:outputLabel for="checkDisplayUserSleeping"
                                                           value="Afficher tout"
                                                           style="font-size:75%;margin-bottom: 10px !important;margin-left: 10px;"/>
                                            <p:selectBooleanCheckbox id="checkDisplayUserSleeping"
                                                                     value="#{cUserMultiView.displaySleepingEntities}"
                                                                     styleClass="small_check"
                                                                     style="vertical-align: middle !important;margin-bottom: 5px !important;">  
                                                <p:ajax update="clientUserList:userDelete 
                                                        :clientUpdate:clientTabView:clientUserList"
                                                        oncomplete="clientUserTable.clearSelection();
                                                        userDeleteButton.disable();forceFilter(clientUserTable);"
                                                        immediate="false"/>
                                                <script type="text/javascript">
                                                    addTitle("clientUpdate\\:clientTabView\\:clientUserList\\:checkDisplayUserSleeping",
                                                             "Affiche les utilisateurs en sommeil en plus de ceux actifs");
                                                </script>
                                            </p:selectBooleanCheckbox>
                                        </p:outputPanel>
                                    </f:facet>
                                </p:dataTable>
                                <script type="text/javascript">
                                    $(document).ready(function()
                                    {
                                        forceFilter(clientUserTable);
                                    });
                                </script>
                            </p:tab>
                            
                            <p:tab id="softwares" title="Logiciels">
                                <p:dataTable id="clientSoftwareList"
                                             var="software"
                                             widgetVar="clientSoftwareTable"
                                             rowIndexVar="index"
                                             paginatorPosition="bottom"
                                             emptyMessage="Aucun logiciel n'a été trouvé"
                                             rowStyleClass="#{software.sleeping?'sleeping_elmt':null}"
                                             value="#{softwareMultiView.getData(clientView.entity.softwareList)}"
                                             paginator="true"
                                             rows="#{utils.maxDataRows}"
                                             sortBy="#{software.id}"
                                             filteredValue="#{softwareMultiView.filteredEntities}"
                                             selection="#{softwareMultiView.multiSelection}">
                                    
                                    <p:ajax event="rowSelectCheckbox"
                                            process="@this"
                                            update=":createSoftwareForm
                                             clientSoftwareList:softwareDelete" />
                                    <p:ajax event="rowUnselectCheckbox"
                                            process="@this"
                                            update=":createSoftwareForm
                                             clientSoftwareList:softwareDelete" />
                                    <p:ajax event="toggleSelect"
                                            process="@this"
                                            update=":createSoftwareForm
                                             clientSoftwareList:softwareDelete" />

                                    <p:column selectionMode="multiple" style="width:2%">
                                    </p:column>

                                    <p:column headerText="Détails" style="width:100%;">
                                        <h:outputText value="#{software.toString()}"/>
                                    </p:column>
                                    
                                    <p:column headerText="Actions" style="white-space: nowrap;">
                                        <p:commandButton actionListener="#{softwareView.entityView(software)}"
                                                         icon="ui-icon-search"
                                                         style="font-size: 60%;"
                                                         title="Détails de ce logiciel"
                                                         update=":createSoftwareForm"
                                                         oncomplete="createSoftware.show();"/>
                                        <p:commandButton actionListener="#{softwareView.entityUpdate(software)}"
                                                         icon="ui-icon-pencil"
                                                         style="font-size: 60%;"
                                                         title="Modifier ce logiciel"
                                                         update=":createSoftwareForm"
                                                         oncomplete="createSoftware.show();"/>
                                        <p:commandButton actionListener="#{softwareView.entityDelete(clientView.entity, software)}"
                                                         action="javascipt:void(0);"
                                                         icon="ui-icon-trash"
                                                         oncomplete="forceFilter(clientSoftwareTable);"
                                                         update=":clientUpdate :growl :clientUpdate:clientTabView:clientSoftwareList"
                                                         style="font-size: 60%;"
                                                         styleClass="red_icon"
                                                         onclick="if(!confirm('#{softwareView.getDeleteMessage(software)}')){return false;}"
                                                         title="Supprimer ce logiciel"/>
                                    </p:column>
                                    
                                    <p:column id="sleepingSoftwareTab"
                                              headerText="État"
                                              sortBy="#{software.sleeping}"
                                              style="width:2%;">
                                        <p:commandButton actionListener="#{softwareView.entityWake(clientView.entity,software)}"
                                                         action="javascript:void(0);"
                                                         icon="ui-icon-play"
                                                         update=":growl :clientUpdate:clientTabView:clientSoftwareList"
                                                         style="font-size: 60%;float:right;"
                                                         styleClass="blue_icon"
                                                         title="Réactiver cet utilisateur"
                                                         rendered="#{software.sleeping}"/>
                                        <p:commandButton id="setSoftwareSleepingButton"
                                                         actionListener="#{softwareView.entitySleep(clientView.entity,software)}"
                                                         action="javascript:void(0);"
                                                         icon="ui-icon-pause"
                                                         oncomplete="clientSoftwareTable.filter();"
                                                         update=":growl :clientUpdate:clientTabView:clientSoftwareList"
                                                         style="font-size: 60%;float:right;"
                                                         onclick="if(!confirm('Voulez vous vraiment mettre ce logiciel en standby?\n'+
                                                                        '(Vous pourrez le réactiver quand vous le souhaitez)'))
                                                                           {return false;}"
                                                         styleClass="red_icon"
                                                         title="Mettre en standby ce logiciel"
                                                         rendered="#{not software.sleeping}"/>
                                    </p:column>
                                    
                                    <f:facet name="footer">
                                        <p:outputPanel style="float:left">
                                            <p:commandButton value="Ajouter un logiciel"
                                                             icon="ui-icon-circle-plus"
                                                             styleClass="green_icon"
                                                             title="Ajouter un logiciel à cette société"
                                                             update=":createSoftwareForm"
                                                             actionListener="#{softwareView.entityCreate(clientView.entity)}"
                                                             onclick="createSoftware.show();"/>
                                            <p:commandButton id="softwareDelete"
                                                             value="Supprimer"
                                                             icon="ui-icon-trash"
                                                             widgetVar="softwareDeleteButton"
                                                             styleClass="red_icon"
                                                             title="Supprimer les logiciels sélectionnés"
                                                             update=":clientUpdate :growl :clientUpdate:clientTabView:clientSoftwareList @this"
                                                             disabled="#{softwareMultiView.emptySelection}"
                                                             actionListener="#{softwareView.remove(clientView.entity,
                                                                               softwareMultiView.multiSelection)}"
                                                             oncomplete="if(#{softwareMultiView.checkEmptySelection()}!='true'){
                                                                    forceFilter(clientSoftwareTable);}"
                                                             onclick="if(#{softwareMultiView.emptySelection})
                                                                {return false;}
                                                                else{if(!confirm('#{softwareView.deleteMessages(softwareMultiView.multiSelectionCast)}')){return false;}}"/>
                                            <p:outputLabel for="checkDisplaySoftwareSleeping"
                                                           value="Afficher tout"
                                                           style="font-size:75%;margin-bottom: 10px !important;margin-left: 10px;"/>
                                            <p:selectBooleanCheckbox id="checkDisplaySoftwareSleeping"
                                                                     value="#{softwareMultiView.displaySleepingEntities}"
                                                                     styleClass="small_check"
                                                                     style="vertical-align: middle !important;margin-bottom: 5px !important;">  
                                                <p:ajax update="clientSoftwareList:softwareDelete 
                                                        :clientUpdate:clientTabView:clientSoftwareList"
                                                        oncomplete="clientSoftwareTable.clearSelection();
                                                        softwareDeleteButton.disable();forceFilter(clientSoftwareTable);"
                                                        immediate="false"/>
                                                <script type="text/javascript">
                                                    addTitle("clientUpdate\\:clientTabView\\:clientSoftwareList\\:checkDisplaySoftwareSleeping",
                                                             "Affiche les logiciels en sommeil en plus de ceux actifs");
                                                </script>
                                            </p:selectBooleanCheckbox>
                                        </p:outputPanel>
                                    </f:facet>
                                </p:dataTable>
                                <script type="text/javascript">
                                    $(document).ready(function()
                                    {
                                        forceFilter(clientSoftwareTable);
                                    });
                                </script>
                            </p:tab>
                            
                            <p:tab id="files" title="Fichiers">
                                <f:event type="preRenderComponent"
                                         listener="#{fileUploadController.setFilePath(
                                                     clientView.entityFilePath)}"/>
                                <p:fieldset legend="Fichiers">
                                    <table style="width:100%;">
                                        <tr>
                                            <td style="vertical-align:top !important;">
                                                <p:fileUpload fileUploadListener="#{fileUploadController.handleFileUpload}"
                                                              mode="advanced"
                                                              dragDropSupport="true"
                                                              multiple="true"
                                                              process="@this"
                                                              update=":growl :clientUpdate:clientTabView:clientFiles"
                                                              sizeLimit="800000000"
                                                              label="Parcourir..."
                                                              uploadLabel="Envoyer"
                                                              cancelLabel="Annuler"
                                                              onstart="startAjax();"
                                                              oncomplete="stopAjax();"
                                                              invalidFileMessage="Type de fichier invalide"
                                                              invalidSizeMessage="Taille du fichier invalide"
                                                              widgetVar="fileUploadVar"
                                                              allowTypes="#{utils.getTextFilesExtensions()}" >
                                                </p:fileUpload>
                                            </td>
                                            <td style="vertical-align:top !important;float:right;">
                                                <p:dataTable id="clientFiles"
                                                             value="#{clientView.entityFilePath.filesInPath}"
                                                             var="file"
                                                             rows="5"
                                                             emptyMessage="Aucun fichier n'est présent"
                                                             paginatorPosition="top"
                                                             sortBy="#{file.name}"
                                                             paginator="true">

                                                    <p:column headerText="Nom">
                                                        <h:outputText value="#{file.name}"/>
                                                    </p:column>

                                                    <p:column headerText="Taille">
                                                        <h:outputText value="#{files.getStringSize(file.length())}"/>
                                                    </p:column>

                                                    <p:column>
                                                        <p:commandButton icon="ui-icon-trash"
                                                                         styleClass="red_icon"
                                                                         style="font-size:60%;"
                                                                         onclick="if(!confirm('#{fileUploadController.getDeleteMessage(file)}'))
                                                                         {return false;}"
                                                                         actionListener="#{fileUploadController.deleteFile(file)}"
                                                                         title="Supprimer ce fichier"
                                                                         update=":growl :clientUpdate:clientTabView:clientFiles"/>
                                                    </p:column>

                                                    <f:facet name="footer">
                                                        <p:outputPanel style="float:left;">
                                                            <p:commandButton action="#{fileUploadController.deleteAllFiles()}"
                                                                             icon="ui-icon-trash"
                                                                             styleClass="red_icon"
                                                                             onclick="if(!confirm('#{fileUploadController.deleteAllMessage}'))
                                                                                        {return false;}"
                                                                             title="Supprimer tous les fichier du serveur"
                                                                             value="Tout supprimer"
                                                                             update=":growl :clientUpdate:clientTabView:clientFiles"
                                                                             disabled="#{fileUploadController.emptyFolder}"/>
                                                        </p:outputPanel>
                                                    </f:facet>

                                                </p:dataTable>
                                            </td>
                                        </tr>
                                    </table>
                                </p:fieldset>
                            </p:tab>
                        </p:tabView>
                    </h:form>
                </f:view>
            </ui:define>
        </ui:composition>
    </h:body>
</html>

